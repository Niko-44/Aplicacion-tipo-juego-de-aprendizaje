<!DOCTYPE html>
<html lang="es">

<head>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#1976d2">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/main.css">

    <title>Mi Panel de Actividades</title>

</head>

<body>
    <div class="container">
        <!-- NUEVO: Controles de accesibilidad - MEJORADO para m√≥viles con dropdown -->
        <div class="accessibility-controls">
            <!-- Botones normales para escritorio -->
            <button id="highContrastBtn" class="accessibility-btn" aria-label="Activar modo de alto contraste">
                <span>üé®</span> Alto Contraste
            </button>
            <button id="largerTextBtn" class="accessibility-btn" aria-label="Aumentar tama√±o del texto">
                <span>üîç</span> Texto Grande
            </button>
            <button id="resetAccessibilityBtn" class="accessibility-btn"
                aria-label="Restablecer ajustes de accesibilidad">
                <span>‚Ü∫</span> Restablecer
            </button>

            <!-- Dropdown para m√≥viles -->
            <div class="accessibility-dropdown">
                <button class="accessibility-dropdown-btn" aria-label="Men√∫ de accesibilidad">
                    <span>‚öôÔ∏è</span> Opciones de Accesibilidad
                    <span>‚ñº</span>
                </button>
                <div class="accessibility-dropdown-content">
                    <button class="accessibility-dropdown-item" data-action="highContrast">
                        <span>üé®</span> Alto Contraste
                    </button>
                    <button class="accessibility-dropdown-item" data-action="largerText">
                        <span>üîç</span> Texto Grande
                    </button>
                    <button class="accessibility-dropdown-item" data-action="resetAccessibility">
                        <span>‚Ü∫</span> Restablecer
                    </button>
                </div>
            </div>
        </div>

        <header class="header">
            <h1>Mi Panel de Actividades</h1>
            <p class="welcome-message">Bienvenido, ¬ølisto para usar la app?</p>
        </header>

        <!-- Sistema de pesta√±as -->
        <div class="tabs-container">
            <div class="tabs">
                <button id="tabMisiones" class="tab active" data-tab="misiones" aria-selected="true" role="tab">Mis
                    Actividades</button>
                <button id="tabLogros" class="tab" data-tab="logros" aria-selected="false" role="tab">Mis
                    Logros</button>
            </div>
        </div>

        <main class="main-content">
            <!-- Pesta√±a de misiones -->
            <div id="tabMisionesContent" class="tab-content active" role="tabpanel" aria-labelledby="tabMisiones">
                <!-- Secci√≥n principal de misiones -->
                <section id="misionesSection" class="misiones-section" aria-labelledby="misiones-title">
                    <h2 id="misiones-title" class="section-title">Mis Actividades</h2>

                    <!-- NUEVO: Tip de ayuda general -->
                    <div id="tipGeneral" class="tip-ayuda">
                        <h4>üí° Consejo del d√≠a</h4>
                        <p id="tipGeneralText">Cada toque en la pantalla es un paso m√°s para comunicarte mejor...</p>
                    </div>

                    <ul id="misionesList" class="misiones-list">
                        <li class="loading">Cargando actividades...</li>
                    </ul>
                    <button id="refreshBtn" class="btn btn-refresh" aria-label="Actualizar lista de actividades">
                        <span class="btn-icon">‚Üª</span> Actualizar
                    </button>
                </section>

                <!-- P√°gina de detalles de misi√≥n -->
                <section id="misionDetallesSection" class="mision-detalles-page" aria-labelledby="mision-detalles-title"
                    style="display:none">
                    <div class="mision-detalles-header">
                        <div>
                            <h2 id="mision-detalles-title" class="mision-detalles-titulo">T√≠tulo de la Misi√≥n</h2>
                            <div class="mision-detalles-descripcion">Descripci√≥n de la misi√≥n</div>
                        </div>
                        <div class="mision-detalles-nivel">Nivel: Principiante</div>
                    </div>

                    <!-- Tip espec√≠fico para la misi√≥n -->
                    <div id="tipMision" class="tip-ayuda">
                        <h4>üí° Tip de apoyo</h4>
                        <p id="tipMisionText">Si algo sale mal, no te preocupes. Puedes volver atr√°s y reintentar las
                            veces que quieras.</p>
                    </div>

                    <!-- Controles de Text-to-Speech -->
                    <div class="tts-controls">
                        <button id="ttsBtn" class="btn btn-tts" aria-label="Escuchar los pasos de la misi√≥n">
                            <span class="btn-icon">üîä</span> Escuchar Pasos
                        </button>
                        <div class="tts-speed-control">
                            <label for="ttsSpeed">Velocidad:</label>
                            <select id="ttsSpeed" aria-label="Seleccionar velocidad de reproducci√≥n">
                                <option value="0.5">Lenta</option>
                                <option value="0.8" selected>Normal</option>
                                <option value="1.2">R√°pida</option>
                                <option value="1.5">Muy r√°pida</option>
                            </select>
                        </div>
                    </div>

                    <div class="pasos-section">
                        <h3 class="section-title">Pasos a seguir</h3>
                        <ol id="pasosList" class="pasos-lista">
                            <!-- Los pasos se cargar√°n din√°micamente aqu√≠ -->
                        </ol>
                    </div>

                    <div class="btn-container">
                        <button id="volverBtn" class="btn btn-volver" aria-label="Volver a la lista de actividades">
                            <span class="btn-icon">‚Üê</span> Volver
                        </button>
                        <button id="terminarBtn" class="btn btn-terminar" aria-label="Marcar misi√≥n como completada">
                            <span class="btn-icon">‚úì</span> Terminar Misi√≥n
                        </button>
                    </div>
                </section>
            </div>

            <!-- Pesta√±a de logros -->
            <div id="tabLogrosContent" class="tab-content" role="tabpanel" aria-labelledby="tabLogros">
                <!-- Secci√≥n de logros -->
                <section id="logrosSection" class="misiones-section" aria-labelledby="logros-title">
                    <h2 id="logros-title" class="section-title">Mis Logros</h2>

                    <div id="logrosContent">
                        <div id="logroActualCard" class="mision-item" style="border-left-color: #e67e22;">
                            <div class="mision-titulo">Logro actual: <span id="logroActualNombre">‚Äî</span></div>
                            <div class="mision-descripcion" id="logroActualDesc">‚Äî</div>
                            <div style="margin-top:10px; font-size:var(--font-size-small); color:var(--medium-gray)">
                                Puntos: <span id="puntosUsuario">0</span></div>
                        </div>

                        <div id="siguienteLogroCard" class="mision-item" style="border-left-color: #5e35b1;">
                            <div class="mision-titulo">Siguiente meta: <span id="siguienteLogroNombre">‚Äî</span></div>
                            <div class="mision-descripcion" id="siguienteLogroDesc">‚Äî</div>
                            <div style="margin-top:10px; font-size:var(--font-size-small); color:var(--medium-gray)">
                                Puntos requeridos:
                                <span id="siguientePuntos">‚Äî</span>
                            </div>
                            <div style="margin-top:12px;">
                                <progress id="logroProgress" value="0" max="100" style="width:100%; height:20px;"
                                    aria-label="Progreso hacia el siguiente logro"></progress>
                            </div>
                        </div>

                        <div style="margin-top:20px;">
                            <h3 class="section-title" style="margin-bottom:15px">Logros desbloqueados</h3>
                            <ul id="logrosDesbloqueadosList" class="misiones-list">
                                <li class="empty">Cargando logros...</li>
                            </ul>
                        </div>

                        <div style="margin-top:15px;">
                            <button id="refreshLogrosBtn" class="btn btn-refresh">‚Üª Actualizar logros</button>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <footer class="footer">
            <p>¬© 2023 Mi Panel de Actividades - Dise√±ado para ser accesible y f√°cil de usar</p>
        </footer>
    </div>

    <script src="js/script.js"></script>

    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(() => console.log('Service Worker registrado'))
                .catch(err => console.error('Error SW:', err));
        }
    </script>
</body>

</html>